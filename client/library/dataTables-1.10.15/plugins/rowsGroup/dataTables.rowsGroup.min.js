(function(d){ShowedDataSelectorModifier={order:"current",page:"current",search:"applied"};GroupedColumnsOrderDir="asc";var f=function(a,c){this.table=a.table();this.columnsForGrouping=c;this.mergeCellsNeeded=this.orderOverrideNow=!1;this.order=[];var b=this;a.on("order.dt",function(a,c){b.orderOverrideNow?b.orderOverrideNow=!1:(b.orderOverrideNow=!0,b._updateOrderAndDraw())});a.on("preDraw.dt",function(a,c){b.mergeCellsNeeded&&(b.mergeCellsNeeded=!1,b._mergeCells())});a.on("column-visibility.dt",
function(a,c){b.mergeCellsNeeded=!0});a.on("search.dt",function(a,c){b.mergeCellsNeeded=!0});a.on("page.dt",function(a,c){b.mergeCellsNeeded=!0});a.on("length.dt",function(a,c){b.mergeCellsNeeded=!0});a.on("xhr.dt",function(a,c){b.mergeCellsNeeded=!0});this._updateOrderAndDraw()};f.prototype={setMergeCells:function(){this.mergeCellsNeeded=!0},mergeCells:function(){this.setMergeCells();this.table.draw()},_getOrderWithGroupColumns:function(a,c){void 0===c&&(c=GroupedColumnsOrderDir);var b=this,d=this.columnsForGrouping.map(function(a){return b.table.column(a).index()}),
k=a.filter(function(a){return 0<=d.indexOf(a[0])}),e=a.filter(function(a){return 0>d.indexOf(a[0])}),f=k.map(function(a){return a[0]}),h=d.map(function(a){var b=f.indexOf(a);return 0<=b?[a,k[b][1]]:[a,c]});h.push.apply(h,e);return h},_getInjectedMonoSelectWorkaround:function(a){if(1===a.length){var c=a[0][0],b=this.order.map(function(a){return a[0]}).indexOf(c);if(0<=b)return[[c,this._toogleDirection(this.order[b][1])]]}return a},_mergeCells:function(){var a=this.table.columns(this.columnsForGrouping,
ShowedDataSelectorModifier).indexes().toArray(),c=this.table.rows(ShowedDataSelectorModifier)[0].length;this._mergeColumn(0,c-1,a)},_mergeColumn:function(a,c,b){b=b.slice();currentColumn=b.shift();currentColumn=this.table.column(currentColumn,ShowedDataSelectorModifier);var g=currentColumn.nodes(),f=currentColumn.data(),e=a;for(a+=1;a<=c;++a)f[a]===f[e]?d(g[a]).hide():(d(g[e]).show(),d(g[e]).attr("rowspan",a-1-e+1),0<b.length&&this._mergeColumn(e,a-1,b),e=a);d(g[e]).show();d(g[e]).attr("rowspan",
a-1-e+1);0<b.length&&this._mergeColumn(e,a-1,b)},_toogleDirection:function(a){return"asc"==a?"desc":"asc"},_updateOrderAndDraw:function(){this.mergeCellsNeeded=!0;var a=this.table.order();a=this._getInjectedMonoSelectWorkaround(a);this.order=this._getOrderWithGroupColumns(a);this.table.order(d.extend(!0,[],this.order));this.table.draw()}};d.fn.dataTable.RowsGroup=f;d.fn.DataTable.RowsGroup=f;d(document).on("init.dt",function(a,c){if("dt"===a.namespace){var b=new d.fn.dataTable.Api(c);if(c.oInit.rowsGroup||
d.fn.dataTable.defaults.rowsGroup){options=c.oInit.rowsGroup?c.oInit.rowsGroup:d.fn.dataTable.defaults.rowsGroup;var g=new f(b,options);d.fn.dataTable.Api.register("rowsgroup.update()",function(){g.mergeCells();return this});d.fn.dataTable.Api.register("rowsgroup.updateNextDraw()",function(){g.setMergeCells();return this})}}})})(jQuery);